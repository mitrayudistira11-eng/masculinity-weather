<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weather GPS Auto</title>

<style>
/* ================= BODY ================= */

body{
margin:0;
font-family:sans-serif;
min-height:100vh;

display:flex;
justify-content:center;
align-items:flex-start;

padding:40px 0;

color:white;
overflow-y:auto;

/* üî• FIX: jangan none */
background:#050b18;

background-size:400% 400%;
animation:bgMove 20s ease infinite;
}

/* gradient move */
@keyframes bgMove{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}

/* ================= TIME BACKGROUND ================= */

body.morning{
background:linear-gradient(-45deg,#FFB75E,#ED8F03,#FFD194,#FF9966);
}
body.day{
background:linear-gradient(-45deg,#56CCF2,#2F80ED,#4facfe,#00c6ff);
}
body.evening{
background:linear-gradient(-45deg,#ff9966,#ff5e62,#f7971e,#ffd200);
}
body.night{
background:linear-gradient(-45deg,#020617,#050b18,#070f1f,#000000);
}

/* ================= SKY ================= */

#sky{
position:fixed;
inset:0;
z-index:0;
pointer-events:none;
overflow:hidden;
}

/* SUN / MOON */

.sunMoon{
position:absolute;
width:120px;
height:120px;
border-radius:50%;
top:15%;
left:50%;
transform:translateX(-50%);
transition:1s;
}

.sun{
background:radial-gradient(circle,#fff799,#ffb347,#ff8800);
box-shadow:0 0 80px rgba(255,180,0,.9);
}

.moon{
background:radial-gradient(circle,#fff,#ccc,#999);
box-shadow:0 0 30px rgba(255,255,255,.6);
}

/* CLOUDS */

.clouds{
position:absolute;
inset:0;
background:
radial-gradient(circle at 20% 40%,rgba(255,255,255,.6) 60px,transparent 70px),
radial-gradient(circle at 60% 30%,rgba(255,255,255,.6) 70px,transparent 80px);
animation:cloudMove 80 ease-in-out infinite;
opacity:.3;
filter:blur(8px);
}

.cloud{
position:absolute;
background:
radial-gradient(circle at 30% 50%, rgba(255,255,255,.95) 60%, transparent 70%),
radial-gradient(circle at 60% 40%, rgba(255,255,255,.9) 70%, transparent 80%),
radial-gradient(circle at 50% 70%, rgba(255,255,255,.9) 65%, transparent 75%);
border-radius:50%;
filter:blur(2px);
pointer-events:none;
}

@keyframes cloudMove{
from{ transform:translateX(-20vw); }
to{ transform:translateX(120vw); }
}

/* STARS */

.stars{
position:absolute;
inset:0;
background-image:
radial-gradient(2px 2px at 20% 30%, white 60%, transparent),
radial-gradient(2px 2px at 70% 60%, white 60%, transparent),
radial-gradient(1px 1px at 40% 80%, white 60%, transparent);
opacity:0;
animation:twinkle 2s infinite alternate ease-in-out;
}

@keyframes twinkle{
from{opacity:.3}
to{opacity:1}
}
/* ===== RAIN PARTICLE ===== */
.rain{
position:absolute;
inset:0;
overflow:hidden;
opacity:0;
}

.drop{
position:absolute;
width:2px;
height:18px;
background:rgba(255,255,255,.9);
border-radius:2px;
transform:rotate(20deg);
animation:rainFall linear infinite;
}

@keyframes rainFall{
from{transform:translate(-40px,-20px) rotate(20deg)}
to{transform:translate(140px,110vh) rotate(20deg)}
}


/* ===== FOG SMOOTH ===== */
.fog{
position:absolute;
inset:0;
opacity:0;
filter:blur(45px);
background:
radial-gradient(circle at 30% 40%,rgba(255,255,255,.25),transparent 60%),
radial-gradient(circle at 70% 60%,rgba(255,255,255,.2),transparent 60%);
}


/* ===== LIGHTNING FLASH ===== */
.flash{
position:absolute;
inset:0;
background:white;
opacity:0;
pointer-events:none;
}/* ================= CARD ================= */

.card{
position:relative;
z-index:10;

width:420px;
max-width:90%;

padding:28px;
border-radius:22px;

background:rgba(8,15,30,0.75);
backdrop-filter:blur(14px);

border:1px solid rgba(255,255,255,0.15);
box-shadow:0 20px 60px rgba(0,0,0,0.45);
}

.big{font-size:48px;font-weight:700}
.section{margin-top:14px;font-size:13px}
</style>
</head>

<body>

<div id="sky">
  <div class="sunMoon" id="sunMoon"></div>
  <div class="stars" id="stars"></div>
  <div class="clouds" id="clouds"></div>
  <div class="fog" id="fog"></div>
<div class="rain" id="rain"></div>
<div class="flash" id="flash"></div>
</div>

<div class="card">
<div id="clock"></div>
<h2 id="city">Mendeteksi lokasi...</h2>
<div class="big" id="temp">--¬∞C</div>
<div id="desc"></div>
<div class="section" id="extra"></div>
<div class="section" id="recommendation"></div>
<div class="section" id="warning"></div>
</div>

<script>

const apiKey="b313e26bc324fe7d98b9611f6767b770";

/* ================= CLOCK ================= */
const clockEl=document.getElementById("clock");
setInterval(()=>{
clockEl.innerText=new Date().toLocaleTimeString();
},1000);

/* ================= GPS ================= */
navigator.geolocation.getCurrentPosition(pos=>{
getWeather(pos.coords.latitude,pos.coords.longitude);
});

/* ================= BACKGROUND ENGINE (FIXED) ================= */
function setDynamicBackground(weatherMain, sunrise, sunset, cloudPercent){

const body=document.body;
const sunMoon=document.getElementById("sunMoon");
const stars=document.getElementById("stars");
const clouds=document.getElementById("clouds");
const fog=document.getElementById("fog");
const rain=document.getElementById("rain");
const flash = document.getElementById("flash");
let lightningInterval=null;

body.className="";

const now=Date.now()/1000;

/* time mode */
let mode="night";

if(now < sunrise){
  mode="night";
}
else if(now < sunrise + 3600){
  mode="morning";
}
else if(now < sunset - 3600){
  mode="day";
}
else if(now < sunset){
  mode="evening";
}
else{
  mode="night";
}

body.classList.add(mode);

/* sun moon */
sunMoon.className="sunMoon "+(mode==="night"?"moon":"sun");
stars.style.opacity=(mode==="night")?1:0;

/* weather effects */
/* reset */
clouds.style.opacity=.2;
fog.style.opacity=0;
rain.style.opacity=0;
sunMoon.style.display="block";
stopLightning();
rain.innerHTML="";

/* cloudy */
setCloudIntensity(cloudPercent);

/* rain */
if(weatherMain.includes("rain") || weatherMain.includes("drizzle")){
  sunMoon.style.display="none";
  clouds.style.opacity=.8;
  fog.style.opacity=.25;
  rain.style.opacity=1;
  createRain(120);
}

/* storm */
if(weatherMain.includes("thunder")){
  sunMoon.style.display="none";
  clouds.style.opacity=.9;
  fog.style.opacity=.35;
  rain.style.opacity=1;
  createRain(220);
  startLightning();
}

/* mist/fog */
if(weatherMain.includes("mist") || weatherMain.includes("fog")){
  fog.style.opacity=.45;
}
}

const flash = document.getElementById("flash");
let lightningInterval=null;

/* HUJAN PARTICLE */
function createRain(n){
  rain.innerHTML="";
  for(let i=0;i<n;i++){
    const d=document.createElement("div");
    d.className="drop";
    d.style.left=Math.random()*100+"%";
    d.style.animationDuration=(0.3+Math.random()*0.5)+"s";
    d.style.animationDelay=Math.random()+"s";
    rain.appendChild(d);
  }
}

/* PETIR */
function startLightning(){
  lightningInterval=setInterval(()=>{
    if(Math.random()<0.35){
      flash.style.opacity=0.9;
      setTimeout(()=>flash.style.opacity=0,80);
      setTimeout(()=>{
        flash.style.opacity=0.6;
        setTimeout(()=>flash.style.opacity=0,60);
      },120);
    }
  },1500);
}

function stopLightning(){
  clearInterval(lightningInterval);
  flash.style.opacity=0;
}

function setCloudIntensity(percent){

const amount = Math.floor(percent*2); // 0‚Äì20 awan
createClouds(amount);

}

function createClouds(n){

const clouds = document.getElementById("clouds");
clouds.innerHTML = "";

for(let i=0;i<n;i++){

  const c = document.createElement("div");
  c.className = "cloud";

  const size = 120 + Math.random()*200;

  c.style.width = size+"px";
  c.style.height = size*0.6+"px";

  c.style.top = Math.random()*80 + "%";
  c.style.left = Math.random()*100 + "%";

  c.style.opacity = 0.3 + Math.random()*0.5;
c.style.zIndex = Math.floor(Math.random()*3);

  c.style.animation = `cloudFloat ${20+Math.random()*30}s ease-in-out infinite`;

  clouds.appendChild(c);
}
}

/* ================= WEATHER ================= */
function getWeather(lat,lon){

fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=id&appid=${apiKey}`)
.then(r=>r.json())
.then(data=>{

setDynamicBackground(
data.weather[0].main.toLowerCase(),
data.sys.sunrise,
data.sys.sunset,
data.clouds.all
);


/* ===== BASIC ===== */

document.getElementById("city").innerText=data.name;
document.getElementById("temp").innerText=Math.round(data.main.temp)+"¬∞C";
const feel = customFeelLike(
data.main.temp,
data.main.humidity,
data.wind.speed,
data.weather[0].main.toLowerCase(),
data.sys.sunrise,
data.sys.sunset
);

const icon = getWeatherIcon(data.weather[0].main);

document.getElementById("desc").innerText=
"RealFeel "+feel+"¬∞C | "+icon+" "+data.weather[0].description;

/* ===== EXTRA DATA ===== */

const wind=data.wind.speed;
const visibility=data.visibility/1000; // km
const pressure=data.main.pressure;
const cloud = data.clouds.all;
const sunrise=formatTime(data.sys.sunrise);
const sunset=formatTime(data.sys.sunset);
const uvData = calculateUV(
feel,
data.clouds.all,
data.wind.speed,
data.visibility/1000,
data.sys.sunrise,
data.sys.sunset
);

let windStatus="Normal";
if(wind>10) windStatus="Kencang ‚ö†Ô∏è";
if(wind>15) windStatus="Sangat kencang ‚õî";

document.getElementById("extra").innerHTML=`
<b>Angin:</b> ${wind} m/s (${windStatus})<br>
<b>Tekanan:</b> ${pressure} hPa<br>
<b>Jarak Pandang:</b> ${visibility} km<br>
<b>Tutupan Awan:</b> ${cloud}%<br>
<b>UV Index:</b> ${uvData.value} (${uvData.category})<br>
<b>Sunrise:</b> ${sunrise}<br>
<b>Sunset:</b> ${sunset}
`;

document.getElementById("recommendation").innerHTML =
recommendation(
    feel,
    data.weather[0].main.toLowerCase(),
    data.wind.speed
);

/* ===== RIDING WARNING ===== */

let warning="Kondisi aman untuk riding motor custom.";

if(data.weather[0].main.toLowerCase().includes("rain")){
warning="‚ö†Ô∏è Jalanan licin! Hindari rebah ekstrem & akselerasi mendadak.";
}

if(visibility<5){
warning+=" ‚ö†Ô∏è Jarak pandang rendah! Gunakan lampu & jaga jarak.";
}

if(wind>10){
warning+=" ‚ö†Ô∏è Waspadai crosswind saat riding.";
}

if(data.weather[0].main.toLowerCase().includes("thunderstorm")){
warning="‚õî Badai petir! Tidak disarankan riding.";
}

document.getElementById("warning").innerHTML="<b>Safety Riding:</b><br>"+warning;

});
}


function customFeelLike(temp, humidity, wind, weatherMain, sunrise, sunset){

const now = Date.now()/1000;
const isDay = (now > sunrise && now < sunset);

let feel = temp;

/* ========================= */
/* ===== SIANG (HEAT) ===== */
/* ========================= */

if(isDay){

// Heat index sederhana
feel = temp + (0.33 * humidity/10) - (0.7 * wind) - 4;

// Matahari terik
if(weatherMain.includes("clear")){
feel += 2;
}

// Mendung ‚Üí sedikit lebih sejuk
if(weatherMain.includes("cloud")){
feel -= 1;
}

// Hujan ‚Üí lebih dingin
if(weatherMain.includes("rain")){
feel -= 2;
}

}

/* ========================= */
/* ===== MALAM (COOL) ===== */
/* ========================= */

else{

// Wind chill sederhana
feel = temp - (wind * 0.7);

// Hujan malam lebih dingin
if(weatherMain.includes("rain")){
feel -= 1.5;
}

// Clear night bisa lebih dingin
if(weatherMain.includes("clear")){
feel -= 1;
}

}

return Math.round(feel);
}

function recommendation(feelLike, weather, wind){

let outfit="";
let activity="";
let warning="";

/* ============================= */
/* ====== SUHU BERDASARKAN FEEL LIKE ====== */
/* ============================= */

if(feelLike >= 38){
outfit="Tanktop breathable / kaos boxy dry-fit + flanel tipis (dibuka) + cargo short + high socks + sneakers mesh ringan + sunglasses + sling bag + sunscreen";
activity="Built Up Custom indoor, Gym ringan pagi/sore. Hindari riding siang terik.";
warning = "‚ö†Ô∏è cuaca panas ekstrem, gunakan alat pendingin ruangan untuk membuat zona suhu nyaman anda tetap stabil.";    
}

else if(feelLike >= 35){
outfit="Kaos oversized premium dry-fit + cargo short + sneakers breathable + cap trucker + jam sporty + kacamata hitam";
activity="Riding Motor Custom jarak dekat sore hari, Hangout, atau Built Up Custom.";
}

else if(feelLike >= 32){
outfit="Workshirt lengan pendek + inner polos + chino slim / cargo tipis + sepatu casual leather / sneakers klasik + jam analog";
activity="Riding Motor Custom, Skateboarding, atau Hangout sore.";
}

else if(feelLike >= 29){
outfit="Workshirt digulung + jeans straight fit ringan + boots ringan / sneakers klasik + sling bag minimalis";
activity="Riding Motor Custom, Memanah outdoor, atau Gym.";
}

else if(feelLike >= 26){
outfit="Coach jacket tipis / rompi + kaos fit + jeans gelap + boots riding + jam field watch";
activity="Camping ringan, Climbing, Riding jarak menengah.";
}

else if(feelLike >= 23){
outfit="Jaket Kulit / denim + inner thermal tipis + celana tebal + boots leather + sarung tangan riding";
activity="Taktikal training ringan, Memanah, atau Built Up Custom.";
}

else if(feelLike >= 20){
outfit="Layering: jacket tebal / mantel + celana tebal + boots + beanie + sarung tangan";
activity="Climbing dingin, perawatan motor detail, latihan taktik.";
}

else{
outfit="Mantel tebal full thermal + celana tebal + boots + beanie + neck warmer";
activity="Fokus indoor: Built Up Custom detail, perencanaan proyek, latihan taktik teori, gym, bobok.";
}


/* ============================= */
/* ===== MODIFIER CUACA ======== */
/* ============================= */

if(weather.includes("rain")){
outfit += " + Jaket waterproof / raincoat set + tas anti air";
activity = "Built Up Custom indoor, Gym, atau latihan taktik indoor.";
warning = "‚ö†Ô∏è Jalanan licin! Hindari akselerasi mendadak dan rebah ekstrem saat riding motor custom.";
}

if(weather.includes("drizzle")){
warning += " ‚ö†Ô∏è Aspal lembap. Jaga jarak pengereman dan hindari ban botak.";
}

if(weather.includes("thunderstorm")){
activity = "Tunda semua aktivitas outdoor. Fokus indoor.";
warning = "‚õî Badai petir! Sangat tidak disarankan riding motor custom.";
}

if(weather.includes("cloud") && feelLike >= 28){
activity += " Cuaca mendukung aktivitas outdoor tanpa panas berlebih.";
}

if(wind > 8){
warning += " üå¨Ô∏è Angin cukup kencang, waspadai crosswind saat riding.";
}


/* ============================= */
/* ===== OUTPUT FINAL ========== */
/* ============================= */

return `
<b>Outfit Rekomendasi:</b><br>${outfit}
<br><br>
<b>Aktivitas Maskulinitas:</b><br>${activity}
<br><br>
<b>Safety Notice:</b><br>${warning || "Kondisi aman untuk aktivitas."}
`;
}

function calculateUV(feelLike, cloud, wind, visibility, sunrise, sunset){

const now = Date.now()/1000;
const isDay = now >= sunrise && now <= sunset;

/* ========================= */
/* ===== NIGHT MODE ======== */
/* ========================= */

if(!isDay){
return { value: 0, category: "Night Mode üåô" };
}

/* ========================= */
/* ===== BASE UV ========= */
/* ========================= */

let uv = 0;

// Basis dari FeelLike (iklim tropis)
if(feelLike >= 38) uv = 11;
else if(feelLike >= 35) uv = 9;
else if(feelLike >= 32) uv = 8;
else if(feelLike >= 29) uv = 6;
else if(feelLike >= 26) uv = 4;
else if(feelLike >= 23) uv = 2;
else uv = 1;

/* ========================= */
/* ===== CLOUD MODIFIER ==== */
/* ========================= */

// Semakin tinggi awan ‚Üí UV turun
let cloudFactor = 1 - (cloud / 120);
if(cloudFactor < 0.2) cloudFactor = 0.2;

uv *= cloudFactor;

/* ========================= */
/* ===== WIND MODIFIER ===== */
/* ========================= */

// Angin kencang ‚Üí radiasi terasa sedikit lebih stabil
if(wind > 10) uv *= 0.9;
if(wind > 15) uv *= 0.8;

/* ========================= */
/* ===== VISIBILITY MOD ===== */
/* ========================= */

// Kabut / jarak pandang rendah ‚Üí UV efektif turun
if(visibility < 5) uv *= 0.8;
if(visibility < 2) uv *= 0.6;

/* ========================= */
/* ===== FINAL ROUND ======= */
/* ========================= */

uv = Math.round(uv);

/* ========================= */
/* ===== CATEGORY ========= */
/* ========================= */

let category = "";

if(uv <= 2) category = "Low";
else if(uv <= 5) category = "Moderate";
else if(uv <= 7) category = "High";
else if(uv <= 10) category = "Very High";
else category = "Extreme ‚òÄÔ∏è";

return { value: uv, category: category };
}

function formatTime(unix){
const d = new Date(unix * 1000);
return d.toLocaleTimeString("id-ID", {
  hour: "2-digit",
  minute: "2-digit"
});
}

function getWeatherIcon(main){

main = main.toLowerCase();

if(main.includes("clear")) return "‚òÄÔ∏è";
if(main.includes("cloud")) return "üå§Ô∏è";
if(main.includes("rain")) return "üåßÔ∏è";
if(main.includes("drizzle")) return "üå¶Ô∏è";
if(main.includes("thunderstorm")) return "‚õàÔ∏è";
if(main.includes("mist") || main.includes("fog")) return "üå´Ô∏è";

return "üå°Ô∏è";
}

</script>

</body>
</html>
